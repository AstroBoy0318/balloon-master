(this.webpackJsonpballoons=this.webpackJsonpballoons||[]).push([[0],{262:function(e,t,n){},279:function(e,t){},302:function(e,t){},304:function(e,t){},380:function(e,t){},382:function(e,t){},39:function(e,t,n){},414:function(e,t){},419:function(e,t){},421:function(e,t){},428:function(e,t){},441:function(e,t){},536:function(e,t){},546:function(e,t,n){"use strict";n.r(t);var s,a=n(65),i=n(8),o=n(43),r=n.n(o),c=(n(262),n(3)),l=n(5),u=n(7),h=n(6),d=n(552),p=n(553),b=(n.p,n(39),n(4)),j=n.n(b),m=n(141),g=n(10),f=n(84),y=n(85),O=n.n(y),v=n(9),w=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={game:null},s}return Object(l.a)(n,[{key:"preload",value:function(){this.load.image("background","./phaser/Background.png"),this.load.spritesheet("balloon","./phaser/Balloon Pop.png",{frameWidth:390,frameHeight:481}),this.load.image("cloudBack","./phaser/Clouds_03_Back.png"),this.load.image("cloudMid","./phaser/Clouds_02_Middle.png"),this.load.image("cloudFront","./phaser/Clouds_01_Front.png")}},{key:"create",value:function(){var e=this,t=this.add.sprite(0,0,"background");t.displayWidth=window.innerWidth,t.displayHeight=window.innerHeight,t.setOrigin(0,0),this.cloudBack=this.add.tileSprite(window.innerWidth/2,window.innerHeight/2,window.innerWidth,window.innerHeight,"cloudBack"),this.cloudBack.setScale(1),this.cloudBack.tileScaleX=.5,this.cloudBack.tileScaleY=.6,this.cloudMid=this.add.tileSprite(window.innerWidth/2,window.innerHeight/2,window.innerWidth,window.innerHeight,"cloudMid"),this.cloudMid.setScale(1),this.cloudMid.tileScaleX=.5,this.cloudMid.tileScaleY=.6,this.cloudFront=this.add.tileSprite(window.innerWidth/2,window.innerHeight/2,window.innerWidth,window.innerHeight,"cloudFront"),this.cloudFront.setScale(1),this.cloudFront.tileScaleX=.5,this.cloudFront.tileScaleY=.6;var n=[];this.anims.create({key:"idle",frames:this.anims.generateFrameNumbers("balloon",{start:0,end:0}),frameRate:64}),this.anims.create({key:"pop",frames:this.anims.generateFrameNumbers("balloon",{start:0,end:16}),frameRate:96});for(var a=function(t){var a=e.physics.add.sprite(Math.random()*window.innerWidth,Math.random()*window.innerHeight,"balloon").setInteractive();n.push(a),n[t].displayWidth=140,n[t].displayHeight=200;var i=400+200*Math.random(),o=300+200*Math.random();n[t].body.maxVelocity={x:i,y:o},n[t].setBounce(1),n[t].setCollideWorldBounds(!0),n[t].body.setGravityY(50+10*t),e.physics.velocityFromRotation,new O.a.Math.Vector2,n[t].setVelocity(i,o),n[t].body.angularVelocity=250+100*Math.random(),n[t].body.angularDrag=0,n[t].on("pointerdown",(function(){s.started&&s.clickBalloon(),n[t].anims.play("pop",!0),n[t].on("animationcomplete",(function(e,s){"pop"==e.key&&(n[t].x=Math.random()*window.innerWidth,n[t].y=100,n[t].anims.play("idle",!0))}),this)}))},i=0;i<3;i++){a(i)}}},{key:"update",value:function(){this.cloudBack.tilePositionX-=.15,this.cloudMid.tilePositionX+=.3,this.cloudFront.tilePositionX-=.75}},{key:"componentWillReceiveProps",value:function(e){s.clickBalloon=e.clickBalloon,s.started=e.gameStarted}},{key:"componentDidMount",value:function(){new O.a.Scene(s);var e={type:O.a.AUTO,parent:"phaser-parent",pixelArt:!1,backgroundColor:"rgba(176, 55, 110,0.5)",width:window.innerWidth,height:window.innerHeight,physics:{default:"arcade",arcade:{gravity:{y:200},debug:!1}},scene:{preload:this.preload,create:this.create,update:this.update}};s=new O.a.Game(e),console.log(s),s.clickBalloon=this.props.clickBalloon,s.started=this.props.gameStarted}},{key:"render",value:function(){return Object(v.jsx)("section",{id:"phaser-parent"})}}]),n}(i.Component),x=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={username:"",password:""},s.handleUsername=s.handleUsername.bind(Object(g.a)(s)),s.handlePassword=s.handlePassword.bind(Object(g.a)(s)),s}return Object(l.a)(n,[{key:"handleUsername",value:function(e){this.setState({username:e.target.value})}},{key:"handlePassword",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"Login",children:[Object(v.jsx)("p",{children:"Username"}),Object(v.jsx)("input",{value:this.state.username,onChange:this.handleUsername}),Object(v.jsx)("br",{}),Object(v.jsx)("p",{children:"Password"}),Object(v.jsx)("input",{type:"password",value:this.state.password,onChange:this.handlePassword}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{className:"midnight-blue-flat-button",onClick:function(){return e.props.login(e.state.username,e.state.password)},children:"LOGIN"}),Object(v.jsx)("div",{className:"divider"}),Object(v.jsx)("button",{className:"midnight-blue-flat-button",onClick:function(){return e.props.register(e.state.username,e.state.password)},children:"REGISTER"})]})}}]),n}(i.Component),k=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"Login",children:[Object(v.jsxs)("p",{children:["Welcome ",this.props.username,"!"]}),Object(v.jsx)("p",{children:"Current Balance:"}),Object(v.jsxs)("h2",{children:[this.props.balance,"uETH"]}),Object(v.jsx)("button",{onClick:function(){return e.props.handlePanels(1)},className:"midnight-blue-flat-button",children:"Top Up"}),Object(v.jsx)("div",{className:"divider"}),Object(v.jsx)("button",{onClick:function(){return e.props.handlePanels(2)},className:"midnight-blue-flat-button",children:"Cash Out"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:this.props.joinGame,className:"midnight-blue-flat-button",children:"JOIN GAME"})]})}}]),n}(i.Component),C=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"Login",children:[Object(v.jsxs)("p",{children:["Welcome ",this.props.username,"!"]}),Object(v.jsxs)("p",{children:["Current Balance: ",this.props.balance]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("p",{children:"Amount"}),Object(v.jsx)("input",{value:this.props.amount,onChange:this.props.handleAmount,type:"number"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("p",{style:{display:"none"},children:"Private Key"}),Object(v.jsx)("input",{value:this.props.privatekey,onChange:this.props.handleKey,style:{width:"100%",display:"none"}}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:function(){return e.props.handlePanels(0)},className:"midnight-blue-flat-button",children:"Back"}),Object(v.jsx)("div",{className:"divider"}),Object(v.jsx)("button",{onClick:this.props.topUp,className:"midnight-blue-flat-button",children:"Top Up"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{})]})}}]),n}(i.Component),S=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"Login",children:[Object(v.jsxs)("p",{children:["Welcome ",this.props.username,"!"]}),Object(v.jsxs)("p",{children:["Current Balance: ",this.props.balance]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("p",{children:"Amount"}),Object(v.jsx)("input",{value:this.props.amount,onChange:this.props.handleAmount,type:"number"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("p",{children:"Receiving Address"}),Object(v.jsx)("input",{value:this.props.coinbase,onChange:this.props.handleAddress}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:function(){return e.props.handlePanels(0)},className:"midnight-blue-flat-button",children:"Back"}),Object(v.jsx)("div",{className:"divider"}),Object(v.jsx)("button",{onClick:this.props.cashOut,className:"midnight-blue-flat-button",children:"Cash Out"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{})]})}}]),n}(i.Component),B=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"Chat",style:{position:"absolute",right:"110px",bottom:"0px",backgroundColor:"#00000052",width:"300px"},children:[Object(v.jsx)("div",{style:{height:"150px",textAlign:"left",overflow:"auto",overflowWrap:"break-word"},children:this.props.messageList.map((function(e){return Object(v.jsxs)("p",{children:[e.sender,": ",e.message]})}))}),Object(v.jsx)("input",{value:this.props.chatMessage,onChange:this.props.handleChat,onKeyPress:function(t){"Enter"===t.key&&e.props.sendMessage()},style:{position:"relative",bottom:"0px",width:"85%"}})]})}}]),n}(i.Component),A=n(101),M=n.n(A),P=new Promise((function(e,t){window.addEventListener("load",(function(){var t={},n=window.web3;if("undefined"!==typeof n)n=new M.a(n.currentProvider),t.web3=n,console.log("Injected web3 detected."),e(t);else{var s=new M.a.providers.HttpProvider("http://ropsten.infura.io/vKci4bjCOf3x7jLLQRWs");n=new M.a(s),t.web3=n,console.log("No web3 instance injected, using Local web3."),e(t)}}))})),N=n(67),I=n(252),W="http://cryptopop.fun:5001/",G=n.n(I)()(W),U=[{constant:!1,inputs:[{name:"amount",type:"uint256"},{name:"user",type:"bytes32"},{name:"userAddress",type:"address"},{name:"newBalance",type:"uint256"}],name:"withdraw",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"bytes32"}],name:"PlayerBalances",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"sender",type:"address"}],name:"changeAdmin",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"user",type:"bytes32"}],name:"deposit",outputs:[{name:"success",type:"bool"}],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"admin",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!0,stateMutability:"payable",type:"constructor"}],H=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={web3:null,currentUser:"",username:"",password:"",sessionId:"",coinbase:"",privateKey:"",key:null,userCount:0,balance:0,spent:0,gameStarted:!1,forcePop:!1,currentPanel:0,amount:0,messageList:[{sender:"GM",message:"Welcome to Balloon Game!"}],chatMessage:""},s.login=s.login.bind(Object(g.a)(s)),s.register=s.register.bind(Object(g.a)(s)),s.getBalance=s.getBalance.bind(Object(g.a)(s)),s.handlePanels=s.handlePanels.bind(Object(g.a)(s)),s.handleKey=s.handleKey.bind(Object(g.a)(s)),s.handleAmount=s.handleAmount.bind(Object(g.a)(s)),s.handleAddress=s.handleAddress.bind(Object(g.a)(s)),s.handleMessageBox=s.handleMessageBox.bind(Object(g.a)(s)),s.joinGame=s.joinGame.bind(Object(g.a)(s)),s.quitGame=s.quitGame.bind(Object(g.a)(s)),s.sendMessage=s.sendMessage.bind(Object(g.a)(s)),s.topUp=s.topUp.bind(Object(g.a)(s)),s.cashOut=s.cashOut.bind(Object(g.a)(s)),s.clickBalloon=s.clickBalloon.bind(Object(g.a)(s)),s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this;G.on("connect",(function(){console.log("connected"),t.setState({sessionId:G.id})})),G.on("ADD",(function(e){console.log(e),t.setState({userCount:e.count})})),G.on("POP",(function(e){console.log(e),t.setState({forcePop:!0})})),G.on("CheckBalance",(function(e){console.log(e),t.getBalance()})),G.on("CHAT",(function(n){if("I won."!==n.message){var s=t.state.messageList;s.push({sender:n.sender,message:n.message}),t.setState({messageList:s})}else e.props.alert.success(n.sender+" won +100.",{position:f.b.MIDDLE})})),P.then((function(t){e.setState({web3:t.web3});t.web3.eth.getAccounts((function(n,s){if(s&&0!=s.length&&e.setState({coinbase:s[0]}),localStorage.getItem("defaultWallet")&&localStorage.getItem("defaultWallet").length>30){var a=localStorage.getItem("defaultWallet"),i=localStorage.getItem("defaultKey");i.length>32&&(i=i.substr(2,i.length-1)),e.setState({coinbase:a,pKey:i});var o=t.web3.eth.accounts.privateKeyToAccount(localStorage.getItem("defaultKey"));console.log(o),console.log(t.web3.eth.accounts.wallet)}})).catch((function(){console.log("Error finding web3.")}))}))}},{key:"register",value:function(e,t){var n=this;console.log("Registering..."),fetch(W+"register/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()})).then((function(s){"Ok"!=s.status?n.props.alert.show(s.status):n.login(e,t)})).catch((function(e){console.log(e)}))}},{key:"login",value:function(e,t){var n=this;fetch(W+"login/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,sessionId:this.state.sessionId})}).then((function(e){return e.json()})).then((function(s){if("Ok"!=s.status)n.props.alert.show(s.status);else{var a=n.state.web3.utils.soliditySha3(e);n.setState({currentUser:a,username:e,password:t},(function(){this.getBalance()}))}})).catch((function(e){console.log(e)}))}},{key:"getBalance",value:function(){var e=Object(m.a)(j.a.mark((function e(){var t,n,s,a=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=N.a.getDefaultProvider("ropsten"),n=new N.a.Contract("0x7Af6faCB28061cFEb5f7D6538B4d63988C8AeE66",U,t),e.next=4,n.PlayerBalances(this.state.currentUser);case 4:s=e.sent,console.log(1e4*N.a.utils.formatEther(s)),this.setState({balance:Number((1e4*N.a.utils.formatEther(s)).toFixed(0))}),fetch(W+"balances/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:this.state.currentUser,sessionId:this.state.sessionId})}).then((function(e){return e.json()})).then((function(e){"Ok"!=e.status?console.log(e.status):(console.log(e.spent),a.setState({spent:Number(e.spent)}))})).catch((function(e){console.log(e)}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clickBalloon",value:function(){var e=this;console.log("CLICKED"),fetch(W+"click/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:this.state.currentUser,key:this.state.key,sessionId:this.state.sessionId})}).then((function(e){return e.json()})).then((function(t){"Winner"==t.status?(e.props.alert.show("+100"),e.setState({spent:e.state.spent+100}),G.emit("CHAT",{sender:e.state.username,message:"I won."})):"Loser"==t.status?(e.props.alert.show("-10"),e.setState({spent:e.state.spent-10})):e.props.alert.show(t.status)})).catch((function(e){console.log(e)}))}},{key:"joinGame",value:function(){var e=this;fetch(W+"joinGame/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:this.state.currentUser,key:this.state.key,sessionId:this.state.sessionId})}).then((function(e){return e.json()})).then((function(t){"Ok"!=t.status?e.props.alert.show(t.status):e.setState({key:t.key,gameStarted:!0})})).catch((function(e){console.log(e)}))}},{key:"topUp",value:function(){var e=Object(m.a)(j.a.mark((function e(){var t,n,s,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new this.state.web3.eth.Contract(U,"0x7Af6faCB28061cFEb5f7D6538B4d63988C8AeE66"),e.next=3,window.ethereum.request({method:"eth_requestAccounts"});case 3:return n=e.sent,s=N.a.utils.parseEther(this.state.amount).toString(),a={gasLimit:53e3,from:n[0],value:s},i=this,t.methods.deposit(this.state.currentUser).send(a).on("transactionHash",(function(){i.props.alert.show("Please Await Transaction"),i.setState({currentPanel:0})})).on("receipt",(function(e){i.props.alert.show("Deposit Confirmed"),i.getBalance()})),e.abrupt("return");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cashOut",value:function(){var e=this;fetch(W+"withdraw/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({key:this.state.key,username:this.state.currentUser,password:this.state.password,address:this.state.coinbase,sessionId:this.state.sessionId,amount:this.state.amount})}).then((function(e){return e.json()})).then((function(t){"Ok"!=t.status?e.props.alert.show(t.status):(e.props.alert.show("Withdrawal Confirmed"),e.setState({currentPanel:0}))})).catch((function(e){console.log(e)}))}},{key:"quitGame",value:function(){var e=this;fetch(W+"quitGame/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:this.state.currentUser,key:this.state.key,sessionId:this.state.sessionId})}).then((function(e){return e.json()})).then((function(t){"Ok"!=t.status?e.props.alert.show(t.status):(e.setState({gameStarted:!1}),e.getBalance())})).catch((function(e){console.log(e)}))}},{key:"sendMessage",value:function(){var e=""==this.state.username?"Guest":this.state.username;G.emit("CHAT",{sender:e,message:this.state.chatMessage}),this.setState({chatMessage:""})}},{key:"handleMessageBox",value:function(e){this.setState({chatMessage:e.target.value})}},{key:"handlePanels",value:function(e){this.setState({currentPanel:e})}},{key:"handleKey",value:function(e){this.setState({privateKey:e.target.value})}},{key:"handleAmount",value:function(e){this.setState({amount:e.target.value})}},{key:"handleAddress",value:function(e){this.setState({coinbase:e.target.value})}},{key:"render",value:function(){var e=[Object(v.jsx)(k,{joinGame:this.joinGame,username:this.state.username,balance:this.state.balance+this.state.spent,handlePanels:this.handlePanels}),Object(v.jsx)(C,{joinGame:this.joinGame,username:this.state.username,balance:this.state.balance+this.state.spent,handlePanels:this.handlePanels,handleAmount:this.handleAmount,amount:this.state.amount,privateKey:this.state.privateKey,handleKey:this.handleKey,topUp:this.topUp}),Object(v.jsx)(S,{joinGame:this.joinGame,username:this.state.username,balance:this.state.balance+this.state.spent,handlePanels:this.handlePanels,coinbase:this.state.coinbase,handleAmount:this.handleAmount,handleAddress:this.handleAddress,amount:this.state.amount,cashOut:this.cashOut})];return Object(v.jsxs)("div",{className:"Home",children:[Object(v.jsxs)("div",{className:"Panel",children:[Object(v.jsx)("h1",{children:"Balloon Game"}),""==this.state.currentUser?Object(v.jsx)(x,{login:this.login,register:this.register}):this.state.gameStarted?null:e[this.state.currentPanel]]}),Object(v.jsx)(w,{userCount:this.state.userCount,clickBalloon:this.clickBalloon,gameStarted:this.state.gameStarted}),Object(v.jsxs)("div",{style:{position:"absolute",left:"0px",top:"0px",backgroundColor:"#00000052",borderRadius:"5px",margin:"10px",color:"white",padding:"5px"},children:[Object(v.jsx)("h1",{children:this.state.userCount}),"Players"]}),Object(v.jsxs)("div",{style:{position:"absolute",right:"0px",top:"0px",backgroundColor:"#00000052",borderRadius:"5px",margin:"10px",color:"white",padding:"5px"},children:["Balance",Object(v.jsx)("h1",{children:this.state.balance+this.state.spent})]}),this.state.gameStarted?Object(v.jsx)("div",{onClick:this.quitGame,style:{position:"absolute",right:"0px",bottom:"0px",backgroundColor:"#00000052",borderRadius:"5px",margin:"10px",color:"white",padding:"5px"},children:"Quit Game"}):null,this.state.gameStarted&&Object(v.jsx)(B,{messageList:this.state.messageList,chatMessage:this.state.chatMessage,handleChat:this.handleMessageBox,sendMessage:this.sendMessage})]})}}]),n}(i.Component),L=Object(f.c)()(H),K=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(d.a,{children:Object(v.jsxs)("div",{children:[Object(v.jsx)(p.a,{exact:!0,path:"/",render:function(e){return Object(v.jsx)(L,Object(a.a)({},e))}}),Object(v.jsx)(p.a,{path:"/exchange",render:function(e){return Object(v.jsx)(w,Object(a.a)({},e))}})]})})})}}]),n}(i.Component),E=n(255);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(v.jsx)(f.a,Object(a.a)(Object(a.a)({template:E.a},{position:"bottom center",timeout:5e3,offset:"30px",transition:"scale"}),{},{children:Object(v.jsx)(K,{})})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[546,1,2]]]);
//# sourceMappingURL=main.b438af44.chunk.js.map